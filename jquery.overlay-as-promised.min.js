!function(e){e.fn.overlayAsPromised=function(o,n,i){var t,c=this,l=[],r={config:{}},s={closable:!0,closeButton:!1,closeLabel:"Close",closeClass:"",startingDelay:0,minDisplayTime:0,maxDisplayTime:0,width:!1,height:!1,maxWidth:!1,maxHeight:!1,top:!1,bottom:!1,left:!1,right:!1,className:!1,transition:"elastic",speed:350,fixed:!1,fitScreen:!1,autoResize:!1};return r.init=function(o,n,i){r.config=e.extend(!0,{},s,o),r.overlay.onOpen=null!=n?n:r.overlay.onOpen,r.overlay.onClose=null!=i?i:r.overlay.onClose,!0===r.config.autoResize&&r.observe(),!0===r.config.closeButton&&c.find("#overlay_close_container").length<1&&(c.append(e('<div id="overlay_close_container" class="overlay-close-container"><button class="overlay-close-button '+r.config.closeClass+'">'+r.config.closeLabel+"</button></div>")),!0===r.config.fitScreen&&(e(".overlay-close-container").addClass("overlay-bottom-fixed"),c.css("width","100%"),c.css("height","100%")),e("#colorbox").on("click",".overlay-close-button",function(){r.overlay.close()}))},r.clearIntervals=function(){l.forEach(function(e){clearInterval(e)})},r.observe=function(){(MutationObserver=window.MutationObserver||window.WebKitMutationObserver,MutationObserver)&&new MutationObserver(function(o,n){e(t).colorbox.resize()}).observe(c[0],{subtree:!0,childList:!0})},r.overlay={open:function(){var o=Date.now(),n=e.Deferred();return setTimeout(function(){t=e.colorbox({inline:!0,href:c,initialWidth:320,open:!0,content:c.html(),closeButton:r.config.closable,overlayClose:r.config.closable,escKey:r.config.closable,fixed:r.config.fixed,width:!0===r.config.fitScreen?window.innerWidth:r.config.width,height:!0===r.config.fitScreen?window.innerHeight:r.config.height,maxWidth:r.config.maxWidth,maxHeight:r.config.maxHeight,top:r.config.top,bottom:r.config.bottom,left:r.config.left,right:r.config.right,className:r.config.className,transition:r.config.transition,speed:r.config.speed,onOpen:function(){return c.show()},onClosed:function(){return r.clearIntervals(),r.overlay.onClose(),c.hide()}}),setTimeout(function(){e.when(r.overlay.onOpen()).then(function(e){n.resolve(e)})},r.config.startingDelay+r.config.minDisplayTime),r.config.maxDisplayTime>0&&l.push(setInterval(function(){if(o+r.config.startingDelay+r.config.maxDisplayTime<Date.now())return r.overlay.close()},50))},r.config.startingDelay),n.promise()},close:function(){var o=e.Deferred();return e.colorbox.close(),e.when(r.overlay.onClose()).then(function(e){o.resolve(e)}),o.promise()},resize:function(){e(t).colorbox.resize()},onOpen:function(){},onClose:function(){}},r.init(o,n,i),Object.create(r.overlay)}}(jQuery);